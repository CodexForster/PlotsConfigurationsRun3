  # ggH_hww_WJets_sr_ele_wp90iso_mu_cut_TightID_POG_ee_high_pt
  # WW_WJets_sr_ele_wp90iso_mu_cut_TightID_POG_ee_high_pt
  # ggH_hww_TTToSemiLeptonic_sr_ele_wp90iso_mu_cut_TightID_POG_ee_high_pt
  # WW_TTToSemiLeptonic_sr_ele_wp90iso_mu_cut_TightID_POG_ee_high_pt
  # ggH_hww_WJets_sr_ele_wp90iso_mu_cut_TightID_POG_ee_low_pt
  # WW_WJets_sr_ele_wp90iso_mu_cut_TightID_POG_ee_low_pt
  # ggH_hww_TTToSemiLeptonic_sr_ele_wp90iso_mu_cut_TightID_POG_ee_low_pt
  # WW_TTToSemiLeptonic_sr_ele_wp90iso_mu_cut_TightID_POG_ee_low_pt
  # ggH_hww_WJets_sr_ele_wp90iso_mu_cut_TightID_POG_em_high_pt
  # WW_WJets_sr_ele_wp90iso_mu_cut_TightID_POG_em_high_pt
  # ggH_hww_TTToSemiLeptonic_sr_ele_wp90iso_mu_cut_TightID_POG_em_high_pt
  # WW_TTToSemiLeptonic_sr_ele_wp90iso_mu_cut_TightID_POG_em_high_pt
  # ggH_hww_WJets_sr_ele_wp90iso_mu_cut_TightID_POG_em_low_pt
  # WW_WJets_sr_ele_wp90iso_mu_cut_TightID_POG_em_low_pt
  # ggH_hww_TTToSemiLeptonic_sr_ele_wp90iso_mu_cut_TightID_POG_em_low_pt
  # WW_TTToSemiLeptonic_sr_ele_wp90iso_mu_cut_TightID_POG_em_low_pt
  # ggH_hww_WJets_sr_ele_wp90iso_mu_cut_TightID_POG_mm_high_pt
  # WW_WJets_sr_ele_wp90iso_mu_cut_TightID_POG_mm_high_pt
  # ggH_hww_TTToSemiLeptonic_sr_ele_wp90iso_mu_cut_TightID_POG_mm_high_pt
  # WW_TTToSemiLeptonic_sr_ele_wp90iso_mu_cut_TightID_POG_mm_high_pt
  # ggH_hww_WJets_sr_ele_wp90iso_mu_cut_TightID_POG_mm_low_pt
  # WW_WJets_sr_ele_wp90iso_mu_cut_TightID_POG_mm_low_pt
  # ggH_hww_TTToSemiLeptonic_sr_ele_wp90iso_mu_cut_TightID_POG_mm_low_pt
  # WW_TTToSemiLeptonic_sr_ele_wp90iso_mu_cut_TightID_POG_mm_low_pt
  # ggH_hww_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_ee_high_pt
  # WW_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_ee_high_pt
  # ggH_hww_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_ee_high_pt
  # WW_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_ee_high_pt
  # ggH_hww_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_ee_low_pt
  # WW_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_ee_low_pt
  # ggH_hww_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_ee_low_pt
  # WW_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_ee_low_pt
  # ggH_hww_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_em_high_pt
  # WW_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_em_high_pt
  # ggH_hww_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_em_high_pt
  # WW_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_em_high_pt
  # ggH_hww_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_em_low_pt
  # WW_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_em_low_pt
  # ggH_hww_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_em_low_pt
  # WW_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_em_low_pt
  # ggH_hww_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_mm_high_pt
  # WW_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_mm_high_pt
  # ggH_hww_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_mm_high_pt
  # WW_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_mm_high_pt
  # ggH_hww_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_mm_low_pt
  # WW_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_mm_low_pt
  # ggH_hww_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_mm_low_pt
  # WW_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_Tight_HWW_mm_low_pt
  # ggH_hww_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_ee_high_pt
  # WW_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_ee_high_pt
  # ggH_hww_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_ee_high_pt
  # WW_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_ee_high_pt
  # ggH_hww_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_ee_low_pt
  # WW_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_ee_low_pt
  # ggH_hww_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_ee_low_pt
  # WW_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_ee_low_pt
  # ggH_hww_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_em_high_pt
  # WW_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_em_high_pt
  # ggH_hww_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_em_high_pt
  # WW_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_em_high_pt
  # ggH_hww_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_em_low_pt
  # WW_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_em_low_pt
  # ggH_hww_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_em_low_pt
  # WW_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_em_low_pt
  # ggH_hww_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_mm_high_pt
  # WW_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_mm_high_pt
  # ggH_hww_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_mm_high_pt
  # WW_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_mm_high_pt
  # ggH_hww_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_mm_low_pt
  # WW_WJets_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_mm_low_pt
  # ggH_hww_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_mm_low_pt
  # WW_TTToSemiLeptonic_sr_ele_mvaWinter22V2Iso_WP90_mu_cut_TightMiniIso_HWW_mm_low_pt


import ROOT

ele_ids  = ["wp90iso","mvaWinter22V2Iso_WP90"]
muon_ids = ["cut_TightID_POG","cut_Tight_HWW","cut_TightMiniIso_HWW"] 

signals     = ["WW","ggH_hww"]
backgrounds = ["TTToSemiLeptonic","WJets"]

final_states = ["ee","em","mm"]
pt_ranges    = ["high_pt","low_pt"]

input_file_name = "eff_plots/efficiencies.root"

colors = [ROOT.kGreen+1,ROOT.kRed+1,ROOT.kBlue,ROOT.kOrange,ROOT.kBlack]

def plot_canvas(input_file_name,
                sig,
                bkg,
                ele_ids,
                muon_ids,
                final_state,
                pt_range,
                output_name):
    """plots a canvas with the requested cuts and processes"""

    input_file = ROOT.TFile(input_file_name)

    first_graph = 0

    # Create canvas
    c1 = ROOT.TCanvas("c1","c1",800,800)
    c1.cd()

    for ele_id in ele_ids:
        for muon_id in muon_ids:
            
            graph_name = f"{sig}_{bkg}_sr_ele_{ele_id}_mu_{muon_id}_{final_state}_{pt_range}"
            print(f"Graph name: {graph_name}")
            
            if first_graph == 0:
                print("Preparing first graph")
                graph = input_file.Get(graph_name)
                if isinstance(graph, ROOT.TGraph): 
                    graph.SetMarkerStyle(20)
                    graph.SetMarkerColor(colors[first_graph])
                    graph.GetXaxis().SetRangeUser(0,1)
                    graph.GetYaxis().SetRangeUser(0,1)
                    graph.Draw("AP")
                    graph.GetXaxis().SetRangeUser(0,1)
                    graph.GetYaxis().SetRangeUser(0,1)
                    first_graph += 1
                    print("First graph plotted!")
                    print(f"Values = ({graph.GetPointX(0)},{graph.GetPointY(0)})")
            else:
                print(f"Preparing graph number {first_graph+1}")
                graph = input_file.Get(graph_name)
                if isinstance(graph, ROOT.TGraph): 
                    graph.SetMarkerStyle(20)
                    graph.SetMarkerColor(colors[first_graph])
                    graph.Draw("P,same")
                    print(f"Graph {first_graph+1} plotted!")
                    print(f"Values = ({graph.GetPointX(0)},{graph.GetPointY(0)})")
                    first_graph += 1


                    
    c1.Print(f"eff_plots/{output_name}.png")
    input_file.Close()
    

#plot_canvas(input_file_name,"WW", "WJets",ele_ids,muon_ids,"ee","high_pt","ee_WW_vs_Wjets")

plot_canvas(input_file_name,"ggH_hww","WJets",ele_ids,muon_ids,"ee","high_pt","ee_ggH_vs_Wjets")
plot_canvas(input_file_name,"ggH_hww","WJets",ele_ids,muon_ids,"em","high_pt","em_ggH_vs_Wjets")
plot_canvas(input_file_name,"ggH_hww","WJets",ele_ids,muon_ids,"mm","high_pt","mm_ggH_vs_Wjets")
